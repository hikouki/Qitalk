!function t(e,n,o){function i(s,p){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!p&&a)return a(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var h=n[s]={exports:{}};e[s][0].call(h.exports,function(t){var n=e[s][1][t];return i(n?n:t)},h,h.exports,t,e,n,o)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)i(o[s]);return i}({1:[function(t,e,n){!function(t,n){"use strict";var o=function(){};o.prototype.init=function(t){this.options=n.extend({host:null,root:"#qitalk",tplDir:"./tpl"},t),this.options.handle=n.extend({start:function(){},presented:function(){}},this.options.handle),this.options.preload=n.extend({tpl:[],service:["ALMemory"]},this.options.preload),this.$root=n(this.options.root),this.tplCache={},this.proxy={},this.subscribeEventIds=[];var e=this;QiSession(function(t){e.qisession=t,e._asyncCacheTpl(),e._asyncCacheService().then(e.options.handle.start)},function(t){console.error("failed connection.")},this.options.host)},o.prototype.presentView=function(t,e){this.params=e;var o=n("<div />");o.css("position","absolute").css("top","0").css("left","0"),t in this.tplCache?(o.html(this.tplCache[t]),this.params=null):o.load(this._makeTplPath(t)),this.$root.children().addClass("qitalk--scrap").css("z-index","-1"),this.$root.prepend(o);var i=this;o.ready(function(){i.$root.find(".qitalk--scrap").remove(),i.options.handle.presented()})},o.prototype.on=function(t,e,o){if(o){if(-1!=n.inArray(o,this.subscribeEventIds))return;this.subscribeEventIds.push(o)}this.$root.on(t,function(){console.log("on: "+t),Array.prototype.shift.apply(arguments),e.apply(null,arguments)});var i=this;this.qisession.service("ALMemory").then(function(e){e.subscriber(t).then(function(e){e.signal.connect(function(e){console.log("trigger: "+t),i.$root.trigger(t,e)})})})},o.prototype.send=function(t,e){this.qisession.service("ALMemory").then(function(n){n.raiseEvent(t,e)})},o.prototype.trigger=function(t,e){this.$root.trigger(t,e)},o.prototype._asyncCacheTpl=function(){var t=this.options.preload.tpl;if(t){var e=this;n(t).each(function(){var t=this;n.ajax({type:"GET",url:e._makeTplPath(this),dataType:"html"}).done(function(n){e.tplCache[t]=n})})}},o.prototype._asyncCacheService=function(){var t=new n.Deferred,e=this.options.preload.service;if(e){var o=this,i=[];return n(e).each(function(){var t=this,e=new n.Deferred;o.qisession.service(t).then(function(n){o.proxy[t]=n,e.resolve()},function(e){console.error("ERROR cache service: "+t)}),i.push(e.promise())}),n.when.apply(null,i).then(function(){t.resolve()}),t.promise()}},o.prototype._makeTplPath=function(t){return this.options.tplDir+"/"+t+".tpl"},"undefined"!=typeof window&&(window.Qitalk=new o),"undefined"!=typeof e&&e.exports&&(e.exports=new o)}(window,jQuery)},{}]},{},[1]);